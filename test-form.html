<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remote Genius Form Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        button {
            background: #3B82F6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #2563EB;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }
        .success {
            background: #D4EDDA;
            color: #155724;
            border: 1px solid #C3E6CB;
        }
        .error {
            background: #F8D7DA;
            color: #721C24;
            border: 1px solid #F5C6CB;
        }
        .info {
            background: #D1ECF1;
            color: #0C5460;
            border: 1px solid #BEE5EB;
        }
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 Remote Genius Form Test</h1>
        
        <button onclick="testGoogleScript()">1. Google Script 연결 테스트</button>
        <button onclick="testFormSubmit()">2. 폼 제출 테스트</button>
        <button onclick="testSlackDirect()">3. Slack 직접 테스트 (CORS 에러 예상)</button>
        
        <div id="result" class="result"></div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxeCF8RcvqRRdnNDS9j0kt_MfTqrVrWphwsVKV5d31fnb2MZm7Ux4HZ_M8ewb3S5U7yjA/exec';
        const SLACK_WEBHOOK_URL = 'https://hooks.slack.com/services/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';
        
        function showResult(message, type = 'info') {
            const resultDiv = document.getElementById('result');
            resultDiv.className = `result ${type}`;
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `<pre>${message}</pre>`;
        }
        
        // 1. Google Script 연결 테스트
        async function testGoogleScript() {
            showResult('Google Script 연결 테스트 중...', 'info');
            
            try {
                const response = await fetch(SCRIPT_URL);
                const data = await response.json();
                showResult(`✅ 성공!\n\n${JSON.stringify(data, null, 2)}`, 'success');
            } catch (error) {
                showResult(`❌ 실패: ${error.message}`, 'error');
            }
        }
        
        // 2. 폼 제출 테스트
        async function testFormSubmit() {
            showResult('폼 데이터 전송 중...', 'info');
            
            const testData = {
                timestamp: new Date().toLocaleString('ko-KR'),
                company: '테스트 회사',
                name: '테스트 담당자',
                position: '대표',
                phone: '010-1234-5678',
                email: 'test@example.com',
                jobs: '웹 개발자, 디자이너',
                urgency: '즉시',
                headcount: '2명',
                budget: '300만원',
                period: '6개월',
                description: '테스트 프로젝트 설명입니다.',
                skills: 'React, Node.js, TypeScript'
            };
            
            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                });
                
                // no-cors 모드에서는 응답을 읽을 수 없으므로 성공으로 간주
                showResult(`✅ 요청 전송 완료!\n\nSlack 채널을 확인해주세요.\n\n전송된 데이터:\n${JSON.stringify(testData, null, 2)}`, 'success');
            } catch (error) {
                showResult(`❌ 실패: ${error.message}`, 'error');
            }
        }
        
        // 3. Slack 직접 테스트 (CORS 에러 예상)
        async function testSlackDirect() {
            showResult('Slack Webhook 직접 테스트 중... (CORS 에러 예상)', 'info');
            
            const slackMessage = {
                text: "🧪 테스트 메시지: Remote Genius Form Handler 테스트"
            };
            
            try {
                const response = await fetch(SLACK_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(slackMessage)
                });
                
                if (response.ok) {
                    showResult('✅ Slack 전송 성공!', 'success');
                } else {
                    showResult(`❌ Slack 응답: ${response.status}`, 'error');
                }
            } catch (error) {
                showResult(`⚠️ 예상된 CORS 에러:\n${error.message}\n\n이는 정상입니다. Slack Webhook은 서버(Google Apps Script)를 통해서만 호출해야 합니다.`, 'error');
            }
        }
    </script>
</body>
</html>